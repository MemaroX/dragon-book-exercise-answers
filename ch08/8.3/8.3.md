# Exercises for Section 8.3

### 8.3.1

Generate code for the following three-address statements assuming stack
allocation where register SP points to the top of the stack.

```
call p
call q
return
call r
return
return
```

#### Answer

```
100:  LD SP, #stackStart
108ï¼š ADD SP, SP, #psize
116:  ST *SP, #132
124:  BR pStart
132:  SUB SP, SP, #psize
140:  ADD SP, SP, #qsize
148:  ST *SP, #164
156:  BR qStart
164:  SUB SP, SP, #qsize
172:  BR **SP
```


### 8.3.2

Generate code for the following three-address statements again assuming stack
allocation and assuming a and b are arrays whose elements are 4-byte values.

1. The four-statement sequence

    ```
    x = a[i]
    y = b[j]
    a[i] = y
    b[j] = x
    ```
2. The three-statement sequence

    ```
    x = a[i]
    y = b[i]
    z = x * y
    ```

3. The three-statement sequence

    ```
    x = a[i]
    y = b[x]
    a[i] = y
    ```
---

## Note

#### 1. Instruction Length

```
120:  ST 364, #140
132:  BR 200
140:  ACTION2
```
Partial code from Figure 8-4

- The label before each instruction line represents the starting position (i.e., offset) of this line of code, and the difference from the label of the next instruction represents the length of this instruction.
- The first line has 1 instruction and 2 constants, so the instruction length is 12. Similarly, the second line has 1 instruction and 1 constant, so the length is 8.


```
100:  LD, SP, #600
108:  ACTION1
128:  ADD SP, SP, #msize
136:  ST *SP, #152
```
Partial code from Figure 8-6

- Since SP does not occupy space, the length of each instruction line in the figure above is 8.